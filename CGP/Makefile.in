# $Id: Makefile.in,v 1.5 2001/02/18 23:24:17 Markus Exp $

# Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
# This Makefile.in is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.

SHELL = @SHELL@

prefix = @prefix@
exec_prefix = @exec_prefix@

top_srcdir =  @top_srcdir@
top_builddir = ..
srcdir = @srcdir@

subdir=CORBA

DESTDIR=

libdir = @libdir@
includedir = @includedir@

AS = @AS@
CC = @CC@
CPP = @CPP@
CXX = @CXX@

CXXLD = $(CXX)

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
INSTALL_DATA = @INSTALL_DATA@
INSTALL_SCRIPT = @INSTALL_SCRIPT@
mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs

MAKEINFO = @MAKEINFO@
PACKAGE = @PACKAGE@
RELEASE = @RELEASE@
VERSION = @VERSION@

INCLUDES =  -I. -I$(top_srcdir) -I$(top_srcdir)/Common
DEFS = @DEFS@
CXXFLAGS = @CXXFLAGS@
CXXCOMPILE = $(CXX) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)

LIBS=-lmico -lAttr

LIBTOOL = @LIBTOOL@

# CORBACOMPILE = mico-shc++
# CORBALINK = mico-shld
CORBACOMPILE = $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
CORBALINK = $(LIBTOOL) --mode=link $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) $(LDFLAGS) -o $@


ifeq (@HAVE_CORBA@,1)
   LIB_TARGETS=libCAttr.la
else
   LIB_TARGETS=
endif

IDL_FILES=CDirSrch.idl
DIST_HEADERS=CIDirSrch.h
HEADERS=CDirSrch.h $(DIST_HEADERS) $(IDL_FILES)
OBJECTS=CDirSrch.lo CIDirSrch.lo Version.lo
SOURCES=$(IDL_FILES) CIDirSrch.cpp Version.cpp

TEXINFO=
EXTRA_DIST=

DIST_COMMON = Makefile.in

DISTFILES = $(DIST_COMMON) $(SOURCES) $(DIST_HEADERS) $(TEXINFOS) $(EXTRA_DIST)


.SUFFIXES: .cc .cpp .lo .o .idl

.idl.cc:
	idl $<
.cc.o:
	$(CORBACOMPILE) -c $(INCLUDES) $<
.cpp.o:
	$(CORBACOMPILE) -c  $(INCLUDES) $<
.cc.lo:
	$(CORBACOMPILE) -c $(INCLUDES) $<
.cpp.lo:
	$(CORBACOMPILE) -c  $(INCLUDES) $<

all: Makefile $(LIB_TARGETS)

libCAttr.la: $(OBJECTS)
	# $(CORBALINK) $(LIBS) $(OBJECTS) -o libCAttr
	$(CORBALINK) -rpath $(libdir) $(LDFLAGS) $(OBJECTS) $(LIBADD) $(LIBS)

Makefile: Makefile.in $(top_builddir)/config.status
	cd $(top_builddir) \
	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status

uninstall:
	@list='$(LIB_TARGETS)'; for p in $$list; do \
	  if test -f $$p; then \
	    $(LIBTOOL)  --mode=uninstall rm -f $(DESTDIR)$(libdir)/$$p; \
	  fi; \
	done
	$(mkinstalldirs) $(DESTDIR)$(includedir)
	@list='$(HEADERS)'; for p in $$list; do \
	  if test -f "$$p"; then d= ; else d="$(srcdir)/"; fi; \
	  rm -f $(DESTDIR)$(includedir)/$$p; \
	done

install:
	$(mkinstalldirs) $(DESTDIR)$(libdir)
	@list='$(LIB_TARGETS)'; for p in $$list; do \
	  if test -f $$p; then \
	    echo "$(LIBTOOL)  --mode=install $(INSTALL) $$p $(DESTDIR)$(libdir)/$$p"; \
	    $(LIBTOOL)  --mode=install $(INSTALL) $$p $(DESTDIR)$(libdir)/$$p; \
	  fi; \
	done
	$(mkinstalldirs) $(DESTDIR)$(includedir)
	@list='$(HEADERS)'; for p in $$list; do \
	  if test -f "$$p"; then d= ; else d="$(srcdir)/"; fi; \
	  $(INSTALL_DATA) $$d$$p $(DESTDIR)$(includedir)/$$p; \
	done

clean:
	@list='$(LIB_TARGETS)'; for p in $$list; do \
	  if test -f "$$p"; then \
	     rm -f $$p; \
	  fi; \
	done
	rm -f *.o core *.core;
	@list=$(IDL_FILES); \
	for i in $$list; do \
	   rm -f $${i%.*}.cc $${i%.*}.h; \
	done

distdir: $(DISTFILES)
	@for file in $(DISTFILES); do \
	  d=$(srcdir); \
	  if test -d $$d/$$file; then \
	    cp -pr $$/$$file $(distdir)/$$file; \
	  else \
	    test -f $(distdir)/$$file \
	    || ln $$d/$$file $(distdir)/$$file 2> /dev/null \
	    || cp -p $$d/$$file $(distdir)/$$file || :; \
	  fi; \
	done

check:
