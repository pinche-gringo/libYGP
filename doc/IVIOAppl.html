<!-- -*-HTML-*- -->

<!-- $Id: IVIOAppl.html,v 1.14 2002/12/25 04:29:13 markus Exp $ -->

<html>
  <head>
    <title>General Reference: IVIOApplication</title>
    <meta name="description" content="Documentation of IVIOApplication-class">
    <meta name="keywords" content="Documentation, Docu, IVIOApplication, class">

    <meta name="DC.Creator" content="Markus Schwab">
    <meta name="DC.Date" content="2000-04-14">
    <meta name="DC.Rights" content="Anticopyright (A) 2000, distributed under the GNU General Public License">
  </head>

  <body bgcolor="#F0F0F0" text="#000000" link="#0000FF" vlink="#000077" alink="#FF0000">
    <table align="center" border="0" cellspacing="10">
      <tr><td><a href="index.html">Class Index</a></td>
      <td><a href="cross_index.html">Cross Index</a></td></tr>
    </table>

    <h1 align="center">Class IVIOApplication</h1>
    <p>Derived from
      <i>none</i>
      <br>
      Derived by: <i>none</i></p>

    <p>#include &lt;IVIOAppl.h&gt;</p>

    <hr noshade>
    <h2>Description</h2>
    <p>Class to handle the startup of a program, which includes reading the data
      stored in an INI file and (afterwards) the parsing of the parameters
      before the actual run of the program. Furthermore in case
      of a segmentation fault a stacktrace is dumped to the systemlog
      (or to stdout).</p>

    <p>Parameters starting with a minus (-) or (only in Windoze) with a slash
      (/) are treated as options and reported via the handleOption-method. Every
      option can also be represented in a verbose way starting with two
      minus-characters (--). What follows is only a short description; more
      information can be found in the <code>getopt</code> man page (which
      unfortunately can't be found on a Windows system, but such is life).</p>

    <p>The parameters are parsed from left to right. Each parameter is
      classified as a short option, a long option (both reported via the
      <a href="IVIOAppl.html#handleOption">handleOption</a>-method), an
      argument to an option, or a non-option parameter.</p>

    <p>A simple short option is a minus (-) or (only in Windoze) a slash (/)
      followed by a short option character. If the option has an argument, it
      may be  written directly after the option character or as the next
      parameter (ie. separated by whitespace on the command line).</p>

    <p>It is possible to specify several short options after one minus (-), as
      long as all (except possibly the last) do not have arguments.</p>

    <p>A long option normally begins with `--'  followed by the long option
      name. If the option has an argument, it may be written directly after the
      long option name, separated by an equal-sign (=), or as the next argument
      (ie. separated by whitespace on the command line). Long options may be
      abbreviated, as long as the abbreviation is not ambiguous.</p>

    <p>Every parameter which is not an option or an argument to an
    option or after a '--'-parameter is a non-option parameter and are
    passed to the <a href="IVIOAppl.html#perform">perform</a>-method.
    Options are inspected before that method is called!</p>

    <p><b>Note</b>: The options "-h" or "-?" causes the call of the showHelp-method!</p>

    <h3>Programmers information</h3>
    <p>Unlike in the UNIX getopt-function, optional paramters need not to be
      marked in a special way. Instead use the
      <a href="IVIOAppl.html#checkOptionValue">checkOptionValue</a>-method to retrieve
      the value of the possible argument, analyze it (like for having no
      leading minus (-)) and retrieve it with the
      <a href="IVIOAppl.html#getOptionValue">getOptionValue</a>-method if OK.</p>

    <hr noshade>
    <table border="0">
      <tr><td colspan="3"><h3>public function member index</h3></td></tr>
      <tr valign="top"><td><tt></tt> </td>
        <td><a href="IVIOAppl.html#IVIOApplication"><b>IVIOApplication</b></a></td>
        <td><tt>(<tt>const</tt> <tt><span style="color:purple;">int</span></tt> <tt><span style="color:blue;">argc</span></tt>, <tt>const</tt> <tt><span style="color:purple;">char</span></tt>* <tt><span style="color:blue;">argv[]</span></tt>, <tt>const</tt> <tt><a href="IVIOAppl.html#IVIOApplication"><b>IVIOApplication</b></a></tt>* <tt><span style="color:blue;">pOpt</span></tt> = NULL)</tt>;</td></tr>
      <tr valign="top"><td><tt><tt>static</tt> <tt><span style="color:purple;">void</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#initI18n"><b>initI18n</b></a></td><td><tt>()</tt>;</td></tr>
      <tr valign="top"><td><tt><tt>static</tt> <tt><span style="color:purple;">void</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#initI18n2"><b>initI18n</b></a></td>
        <td><tt>(<tt>const</tt> <tt><span style="color:purple;">char</span></tt>* <tt><span style="color:blue;">package</span></tt>, <tt>const</tt> <tt><span style="color:purple;">char</span></tt>* <tt><span style="color:blue;">dir</span></tt>)</tt>;</td></tr>
      <tr valign="top"><td><tt><tt><span style="color:purple;">int</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#run"><b>run</b></a></td>
        <td><tt>()</tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> </tt> </td>
        <td><a href="IVIOAppl.html#~IVIOApplication"><b>~IVIOApplication</b></a></td>
        <td><tt>()</tt>;</td></tr>
      <tr><td>&nbsp;</td></tr>

      <tr><td colspan="3"><h3>protected function member index</h3></td></tr>
      <tr valign="top"><td><tt><tt>const</tt> <tt><span style="color:purple;">char</span></tt>*</tt> </td>
        <td><a href="IVIOAppl.html#checkOptionValue"><b>checkOptionValue</b></a></td>
        <td><tt>() <tt>const</tt></tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> <tt>const</tt> <tt><span style="color:purple;">char</span></tt>*</tt> </td>
        <td><a href="IVIOAppl.html#description"><b>description</b></a></td>
        <td><tt>() <tt>const</tt></tt>;</td></tr>
      <tr valign="top"><td><tt><tt>const</tt> <tt><span style="color:purple;">char</span></tt>*</tt> </td>
        <td><a href="IVIOAppl.html#filename"><b>filename</b></a></td>
        <td><tt>() <tt>const</tt></tt>;</td></tr>
      <tr valign="top"><td><tt><tt>const</tt> <tt><span style="color:purple;">char</span></tt>*</tt> </td>
        <td><a href="IVIOAppl.html#getOptionValue"><b>getOptionValue</b></a></td>
        <td><tt>()</tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> <tt><span style="color:purple;">bool</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#handleOption"><b>handleOption</b></a></td>
        <td><tt>(<tt>const</tt> <tt><span style="color:purple;">char</span></tt> <tt><span style="color:blue;">option</span></tt>)</tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> <tt>const</tt> <tt><span style="color:purple;">char</span></tt>*</tt> </td>
        <td><a href="IVIOAppl.html#name"><b>name</b></a></td>
        <td><tt>() <tt>const</tt></tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> <tt><span style="color:purple;">int</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#perform"><b>perform</b></a></td>
        <td><tt>(<tt><span style="color:purple;">int</span></tt> <tt><span style="color:blue;">argc</span></tt>, <tt>const</tt> <tt><span style="color:purple;">char</span></tt>* <tt><span style="color:blue;">argv[]</span></tt>)</tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> <tt><span style="color:purple;">void</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#readINIFile"><b>readINIFile</b></a></td>
        <td><tt>(<tt>const</tt> <tt><span style="color:purple;">char</span></tt>* <tt><span style="color:blue;">pFile</span></tt>)</tt>;</td></tr>
      <tr valign="top"><td><tt><tt><span style="color:purple;">void</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#setLongOptions"><b>setLongOptions</b></a></td>
        <td><tt>(<tt>const</tt> <tt><span style="color:navy;">longOptions</span></tt>* <tt><span style="color:blue;">pLongOpts</span></tt>)</tt>;</td></tr>
      <tr valign="top"><td><tt><tt><span style="color:purple;">void</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#setLongOptions"><b>setLongOptions</b></a></td>
        <td><tt>(<tt>const</tt> <tt><span style="color:navy;">longOptions</span></tt>* <tt><span style="color:blue;">pLongOpts</span></tt>, <tt><span style="color:navy;">unsigned</span></tt> <tt><span style="color:purple;">int</span></tt> <tt><span style="color:blue;">numLongOpts</span></tt>)</tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> <tt><span style="color:purple;">bool</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#shallShowInfo"><b>shallShowInfo</b></a></td>
        <td><tt>() <tt>const</tt></tt>;</td></tr>
      <tr valign="top"><td><tt><tt>virtual</tt> <tt><span style="color:purple;">void</span></tt></tt> </td>
        <td><a href="IVIOAppl.html#showHelp"><b>showHelp</b></a></td>
        <td><tt>() <tt>const</tt></tt>;</td></tr>
    </table>

    <hr noshade>
    <h2>Member descriptions</h2>

    <h3 style="color:navy;">Management functions</h3>
    <pre><a name="IVIOApplication"></a> <b>IVIOApplication</b> (const int argc, const char* argv[], const longOptions* pOpt)</pre>
    <dl>
      <dd><p>Constructor; the parameters specify the number of and an array with
        the program-arguments (as passed to the main-function) and a table to
        map the verbose long-options to their short equivalent. If the third
        parameter is NULL, no long options are used.</p></dd>
      <dd><dl><dt><b>Parameters</b></dt>
          <dd><code>argc</code>: Number of arguments
          <dd><code>argv</code>: Array of pointers to argumetns</dd>
          <dd><code>pOpt</code>: Pointer to long-option-table</dd>
      </dl></dd>
    </dl>
    <hr>
    <pre><a name="IVIOApplication"></a>IVIOApplication (const int argc, const char* argv[], const <a href="IVIOAppl.html#longOptions">longOptions</a>* pOpt = NULL)</pre>
    <dl>
      <dd></dd>
    </dl>
    <pre><a name="~IVIOApplication"></a> <b>~IVIOApplication</b> ()</pre>
    <dl>
      <dd><p>Destructor</p></dd>
    </dl>
    <hr>
    <pre><a name="initI18n"></a>void <b>initI18n</b> ()</pre>
    <dl>
      <dd><p>Initializes the program for internationalization by setting the current locale.</p></dd>
    </dl>
    <hr>
    <pre><a name="initI18n2"></a>void <b>initI18n</b> (const char* package, const char* dir)</pre>
    <dl>
      <dd><p>Initializes program for internationalization by setting the current
         locale and additionaly loading the message file.</p></dd>
      <dd><dl><dt><b>Parameters</b></dt>
          <dd><code>package</code>: Name of the message-catalog</dd>
          <dd><code>dir</code>: root-directory for message-catalogs</dd>
      </dl></dd>
      <dd><dl><dt><b>Remarks</b></dt>
          <dd>If the GNU gettext library is not installed or supported, the methods only sets the locale!</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="run"></a>int <b>run</b> ()</pre>
    <dl>
      <dd><p>Runs the application; first the method readINIFile is called to read
        the data from an INI file. Then the options are checked. If an invalid or
        a help-option is passed, the help-screen is displayed, else the
        actual job of the application is performed.</p></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>int: Status</dd></dl></dd>
    </dl>

    <h3 style="color:navy;">Option handling</h3>
    <pre><a name="handleOption"></a>bool <b>handleOption</b> (const char option) = 0</pre>
    <dl>
      <dd><p>Checks if the passed option is supported by the application. This
        method must return true, if yes and false if not. In the second case
        the help is displayed and the program terminates with an error-code of
        -1.</p>
        <p>To be implemented by derived classes.</p></dd>
      <dd><dl><dt><b>Parameters</b></dt>
          <dd><code>option</code>: Option to inspect</dd>
      </dl></dd>
    </dl>
    <hr>
    <pre><a name="getOptionValue"></a>const char* <b>getOptionValue</b> ()</pre>
    <dl>
      <dd><p>Returns parameters to the actual option and increases the pointer to
        the next option. These parameters are searched
        using the following algorithm:</p>
        <ul style="list-style-type:disc;">
          <li>The remaining characters in a list of simple options (e.g. if
            called for the option d in "-dlevel1" the method would return
            "level1") or the value behind the equal sign (=) if given in
            a long option.</li>
          <li>The next argument of the application.</li>
          <li>NULL</li>
        </ul></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>char*: Parameter for the option</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="checkOptionValue"></a>const char* <b>checkOptionValue</b> ()</pre>
    <dl>
      <dd><p>Returns parameters to the actual option. These parameters are searched
        using the following algorithm:</p>
        <ul style="list-style-type:disc;">
          <li>The remaining characters in a list of simple options (e.g. if
            called for the option d in "-dlevel1" the method would return
            "level1") or the value behind the equal sign (=) if given in
            a long option.</li>
          <li>The next argument of the application.</li>
          <li>NULL</li>
        </ul></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>char*: Parameter for the option</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="setLongOptions"></a>void <b>setLongOptions</b> (const <a href="IVIOAppl.html#longOptions">longOptions</a>* pLongOpts)</pre>
    <dl>
      <dd><p>Sets a table which maps options to a verbose version. This table must
        be terminated with an entry where the short option is '\0' and the
        associated long options is NULL; the previous entries must not have
        lines with those values.</p></dd>
      <dd><dl><dt><b>Parameters</b></dt>
          <dd><code>pLongOptions</code>: Pointer to an array of longOptions; terminated with a longOption with NULL as longVal</dd>
      </dl></dd>
      <dd><dl><dt><b>Requires</b></dt>
          <dd>- pLongOpts not NULL; all long-entries not NULL; all short-entries not '\0'</dd>
          <dd>- An entry with an { NULL, '\0' } at the end</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="setLongOptions2"></a>void <b>setLongOptions</b> (const <a href="IVIOAppl.html#longOptions">longOptions</a>* pLongOpts, unsigned int numLongOpts)</pre>
    <dl>
      <dd><p>Sets a table which maps options to a verbose version. This table
        must not contain entries with either '\0' as short option or NULL as
        long option.</p></dd>
      <dd><dl><dt><b>Parameters</b></dt>
          <dd><code>pLongOptions</code>: Pointer to an array of longOptions</dd>
          <dd><code>numLongOpts</code>: Number of elements in the array</dd>
      </dl></dd>
      <dd><dl><dt><b>Requires</b></dt>
          <dd>pLongOpts not NULL; all long-entries not NULL; all short-entries not '\0'</dd></dl></dd>
    </dl>
    <hr>

    <h3 style="color:navy;">Program handling</h3>
    <pre><a name="readINIFile"></a>void <b>readINIFile</b> (const char* pFile)</pre>
    <dl>
      <dd><p>Intended to read data from the passed INI file. To be implemented by
        derived classes.</p></dd>
      <dd><dl><dt><b>Parameters</b></dt>
          <dd><code>pFile</code>: Pointer to a character array holding the name of the file</dd>
      <dd><dl><dt><b>Requires</b></dt>
          <dd>pFile a valid ASCIIZ-string and not NULL.</dd></dl></dd>
      </dl></dd>
    </dl>
    <hr>
    <pre><a name="perform"></a>int <b>perform</b> (int argc, const char* argv[]) = 0</pre>
    <dl>
      <dd><p>Performs the job of the application. The return-code of this method
        is returned as error-code of the application.<p>
        <p>To be implemented by derived classes.</p></dd>
      <dd><dl><dt><b>Parameters</b></dt>
          <dd><code>argc</code>: Number of arguments passed in argv</dd>
          <dd><code>argv</code>: Array of argument pointers</dd>
      </dl></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>int: Status of program run</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="name"></a>const char* <b>name</b> () const</pre>
    <dl>
      <dd><p>Returns the name of the application. The default action is to return
        the name of the file as stored in index 0 of the argv-array, stripped by
        any path information.</p></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>const char*: Name of programm</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="description"></a>const char* <b>description</b> () const = 0</pre>
    <dl>
      <dd><p>Returns a description to the program. This text must start with the
        version-number.</p>
        <p>To be implemented by derived classes.</p></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>const char*: Text to display as version info</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="filename"></a>const char* <b>filename</b> () const</pre>
    <dl>
      <dd><p>Returns the filename of the application as stored in index 0 of the
	argv-array.</p></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>const char*: Name of programm as provided by the system.</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="shallShowInfo"></a>bool <b>shallShowInfo</b> () const</pre>
    <dl>
      <dd><p>Specifies if the application shall display the program-info
        (consisting of name and description).</p></dd>
      <dd><dl><dt><b>Returns</b></dt>
          <dd>bool: Flag, if the program-info shall be displayed; true if yes</dd></dl></dd>
    </dl>
    <hr>
    <pre><a name="showHelp"></a>void <b>showHelp</b> () const = 0</pre>
    <dl>
      <dd><p>Intended to displays the help-screen of the application.</p>
        <p>To be implemented by derived classes.</p></dd>
    </dl>

    <hr noshade>

    <table align="center" border="0" cellspacing="10">
      <tr><td><a href="index.html">Class Index</a></td></tr>
    </table>

    <h1 align="center"><a name="longOptions">Struct IVIOApplication::longOptions</a></h1>
    <p>Derived from
      <i>none</i>
      <br>
      Derived by: <i>none</i></p>

    <p>#include &lt;IVIOAppl.h&gt;</p>

    <hr noshade>
    <h2>Description</h2>
    <p>Structure to associate long (verbose) options with the corrosponding
      short version.</p>

    <hr noshade>
    <table border="0">
      <tr valign="top"><td colspan="2"><h3>public variable member index</h3></td></tr>
      <tr valign="top"><td><tt><span style="color:purple;">char</span>* </tt></td><td><tt><span style="color:blue;">longVal</span></tt></td></tr>
      <tr valign="top"><td><tt><span style="color:purple;">char</span> </tt></td><td><tt><span style="color:blue;">shortVal</span></tt></td></tr>
    </table>
  </body>
</html>
